

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quantum Key Distribution - B92 &mdash; QuNetSim  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quantum Coin Flipping" href="quantum_coin_flipping.html" />
    <link rel="prev" title="Quantum Key Distribution - BB84" href="QKD_BB84.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/Psirocket_white.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#overview-video">Overview Video</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#what-is-qunetsim">What is QuNetSim?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#who-should-use-qunetsim">Who should use QuNetSim?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#via-pip">Via pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#linux-mac-os-x">Linux / Mac OS X</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#windows">Windows</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start Guide</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../design.html">Design Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../components.html">Network Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/host.html">Host</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/network.html">Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/protocols.html">Protocols</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../objects.html">Network Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../objects/message.html">Message</a></li>
<li class="toctree-l3"><a class="reference internal" href="../objects/qubit.html">Qubit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../objects/quantum_storage.html">Quantum Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../objects/classical_storage.html">Classical Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../objects/quantum_connection.html">Quantum Connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../objects/classical_connection.html">Classical Connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../objects/packet.html">Packet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../objects/routing_packet.html">Routing Packet</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../backends.html">Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backends.html#writing-your-own-backend">Writing your own Backend</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="send_data.html">Send Data Qubits</a></li>
<li class="toctree-l2"><a class="reference internal" href="send_epr.html">Send EPR Pairs</a></li>
<li class="toctree-l2"><a class="reference internal" href="send_w.html">Send W State</a><ul>
<li class="toctree-l3"><a class="reference internal" href="send_w.html#w-state">W state</a></li>
<li class="toctree-l3"><a class="reference internal" href="send_w.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="chsh.html">CHSH Game</a></li>
<li class="toctree-l2"><a class="reference internal" href="packet_sniffing.html">Eavesdropping on channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="quantum_money.html">Quantum Money with a Man-in-the-Middle Attack</a></li>
<li class="toctree-l2"><a class="reference internal" href="entanglement_routing.html">Routing with Entanglement</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="QKD.html">Quantum Key Distribution</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="QKD_BB84.html">Quantum Key Distribution - BB84</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Quantum Key Distribution - B92</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quantum_coin_flipping.html">Quantum Coin Flipping</a></li>
<li class="toctree-l2"><a class="reference internal" href="anonymous_transfer.html">GHZ Based Anonymous Entanglement</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuNetSim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
          <li><a href="QKD.html">Quantum Key Distribution</a> &raquo;</li>
        
      <li>Quantum Key Distribution - B92</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/QKD_B92.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quantum-key-distribution-b92">
<h1>Quantum Key Distribution - B92<a class="headerlink" href="#quantum-key-distribution-b92" title="Permalink to this headline">Â¶</a></h1>
<p>The Quantum Key Distribution B92 protocol was proposed in 1992 by Charles Bennett. It is a modified version of the BB84 protocol.
This protocol is different from the BB84 in the following ways:</p>
<ol class="arabic simple">
<li><p>It uses two possible states of qubits being sent instead of four.</p></li>
<li><p>Alice and Bob do not need to compare bases at any point.</p></li>
</ol>
<p>A detailed description of this protocol can be found <a class="reference external" href="http://www.rri.res.in/quic/qkdactivities.php">here</a></p>
<p>First, we create a network with three hosts, Alice, Bob and Eve. Alice will send her qubits to Bob and Eve will, or will not, eavesdrop and manipulate the qubits she intercepts.
The network will link Alice to Eve, Eve to Alice and Bob, and Bob to Eve.
Here is also the place to define which function will Eve run if the eavesdropping is turned on.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build_network_b92</span><span class="p">(</span><span class="n">eve_interception</span><span class="p">):</span>

    <span class="n">network</span> <span class="o">=</span> <span class="n">Network</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span>
    <span class="n">network</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="n">host_alice</span> <span class="o">=</span> <span class="n">Host</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">)</span>
    <span class="n">host_bob</span> <span class="o">=</span> <span class="n">Host</span><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">)</span>
    <span class="n">host_eve</span> <span class="o">=</span> <span class="n">Host</span><span class="p">(</span><span class="s1">&#39;Eve&#39;</span><span class="p">)</span>

    <span class="n">host_alice</span><span class="o">.</span><span class="n">add_connection</span><span class="p">(</span><span class="s1">&#39;Eve&#39;</span><span class="p">)</span>
    <span class="n">host_eve</span><span class="o">.</span><span class="n">add_connections</span><span class="p">([</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">])</span>
    <span class="n">host_bob</span><span class="o">.</span><span class="n">add_connection</span><span class="p">(</span><span class="s1">&#39;Eve&#39;</span><span class="p">)</span>
    <span class="c1"># Adding the connections - Alice wants to transfer an encrypted message to Bob</span>
    <span class="c1"># The network looks like this: Alice---Eve---Bob</span>

    <span class="n">host_alice</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">host_bob</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="mf">0.3</span>

    <span class="c1"># starting</span>
    <span class="n">host_alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">host_bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">host_eve</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="n">network</span><span class="o">.</span><span class="n">add_hosts</span><span class="p">([</span><span class="n">host_alice</span><span class="p">,</span> <span class="n">host_bob</span><span class="p">,</span> <span class="n">host_eve</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">eve_interception</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">host_eve</span><span class="o">.</span><span class="n">q_relay_sniffing</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">host_eve</span><span class="o">.</span><span class="n">q_relay_sniffing_fn</span> <span class="o">=</span> <span class="n">eve_sniffing_quantum</span>

    <span class="n">hosts</span> <span class="o">=</span> <span class="p">[</span><span class="n">host_alice</span><span class="p">,</span><span class="n">host_bob</span><span class="p">,</span><span class="n">host_eve</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Made a network!&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">network</span><span class="p">,</span> <span class="n">hosts</span>
</pre></div>
</td></tr></table></div>
<p>First, a random encryption key of a certain length is generated. The key is a list of binary numbers.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_key</span><span class="p">(</span><span class="n">key_length</span><span class="p">):</span>
    <span class="n">generated_key</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">key_length</span><span class="p">):</span>
        <span class="n">generated_key</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Generated the key {generated_key}&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">generated_key</span>
</pre></div>
</td></tr></table></div>
<p>We now implement the B92 protocol. For each bit in the encrypted key, Alice generates and sends a qubit to Bob.
If the bit she wants to send is 0, she sends a <span class="math notranslate nohighlight">\(|0\rangle\)</span>, and if the bit is 1, she sends <span class="math notranslate nohighlight">\(|+\rangle\)</span>.</p>
<p>Then, after she sends the qubit, she waits for a (classical) message from Bob.
If Bob tells her he measured the qubit and extracted the information, she prepares and sends the next one.
Otherwise, she sends the information concerning this bit again and again, until a confirmation is received.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sender_qkd</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">,</span> <span class="n">receiver</span><span class="p">):</span>
    <span class="n">sent_qubit_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">secret_key</span><span class="p">:</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">while</span> <span class="n">success</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">qubit</span> <span class="o">=</span> <span class="n">Qubit</span><span class="p">(</span><span class="n">alice</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">qubit</span><span class="o">.</span><span class="n">H</span><span class="p">()</span>
            <span class="c1"># If we want to send 0, we&#39;ll send |0&gt;</span>
            <span class="c1"># If we want to send 1, we&#39;ll send |+&gt;</span>
            <span class="n">alice</span><span class="o">.</span><span class="n">send_qubit</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">qubit</span><span class="p">,</span> <span class="n">await_ack</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">get_next_classical</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">wait</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="o">==</span> <span class="s1">&#39;qubit successfully acquired&#39;</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Alice sent qubit {sent_qubit_counter + 1} to Bob&#39;</span><span class="p">)</span>
                    <span class="n">success</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">sent_qubit_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c1"># if, however, message says Bob failed to measure the qubit,</span>
                <span class="c1"># Alice will resend it.</span>
</pre></div>
</td></tr></table></div>
<p>Bob receives the qubit Alice sent, and randomly chooses a base (rectilinear or diagonal) for the qubit measurement.
If he chooses the rectilinear basis, and the measurement yields the state <span class="math notranslate nohighlight">\(|1\rangle\)</span>, then Bob knows that Eveâs qubit was <span class="math notranslate nohighlight">\(|+\rangle\)</span>, and therefore the bit she sent was 1.
Bob sends Alice a classical message after the measurement and tells her whether he succeeded or failed to extract the information.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">receiver_qkd</span><span class="p">(</span><span class="n">bob</span><span class="p">,</span> <span class="n">key_size</span><span class="p">,</span> <span class="n">sender</span><span class="p">):</span>
    <span class="n">key_array</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">received_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">#counts the key bits successfully measured by Bob</span>
    <span class="k">while</span> <span class="n">received_counter</span> <span class="o">&lt;</span> <span class="n">key_size</span><span class="p">:</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
             <span class="c1"># 0 means rectilinear basis and 1 means diagonal basis</span>
        <span class="n">qubit</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">get_qubit</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span><span class="n">wait</span> <span class="o">=</span> <span class="n">wait_time</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">qubit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">qubit</span><span class="o">.</span><span class="n">H</span><span class="p">()</span>
            <span class="n">bit</span> <span class="o">=</span> <span class="n">qubit</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">resulting_key_bit</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">elif</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">resulting_key_bit</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">message_to_send</span> <span class="o">=</span> <span class="s1">&#39;qubit successfully acquired&#39;</span>
                <span class="n">key_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resulting_key_bit</span><span class="p">)</span>
                <span class="n">received_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Bob received qubit {received_counter}&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">message_to_send</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
            <span class="n">bob</span><span class="o">.</span><span class="n">send_classical</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span><span class="n">message_to_send</span><span class="p">,</span> <span class="n">await_ack</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">key_array</span>
</pre></div>
</td></tr></table></div>
<p>After sending all of the bits of the encrypted key, Alice and Bob should check whether Eve eavesdropped on the channel.
For this purpose, each of them takes for comparison a certain part of the encrypted key they have.
Alice classically sends part of the key she has to Bob. He compares it to the part he has. If itâs the same information, he sends her a message informing her that the key was transferred without eavesdropping. If, however, the part he receives is different from what he has, it means eavesdropping occurred and he sends a message to inform Alice about it.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_key_sender</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">key_check_alice</span><span class="p">,</span> <span class="n">receiver</span><span class="p">):</span>
    <span class="n">key_check_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">key_check_alice</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Alice</span><span class="se">\&#39;</span><span class="s1">s key to check is {key_check_string}&#39;</span><span class="p">)</span>
    <span class="n">alice</span><span class="o">.</span><span class="n">send_classical</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">key_check_string</span><span class="p">,</span> <span class="n">await_ack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">message_from_bob</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">get_next_classical</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">wait</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Bob tells Alice whether the key part is the same at his end.</span>
    <span class="c1"># If not - it means Eve eavesdropped.</span>
    <span class="k">if</span> <span class="n">message_from_bob</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">message_from_bob</span><span class="o">.</span><span class="n">content</span> <span class="o">==</span> <span class="s1">&#39;Success&#39;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Key is successfully verified&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">message_from_bob</span><span class="o">.</span><span class="n">content</span> <span class="o">==</span> <span class="s1">&#39;Fail&#39;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Key has been corrupted&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_key_receiver</span><span class="p">(</span><span class="n">bob</span><span class="p">,</span> <span class="n">key_check_bob</span><span class="p">,</span><span class="n">sender</span><span class="p">):</span>
    <span class="n">key_check_bob_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">key_check_bob</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Bob</span><span class="se">\&#39;</span><span class="s1">s key to check is {key_check_bob_string}&#39;</span><span class="p">)</span>
    <span class="n">key_from_alice</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">get_next_classical</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">wait</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">key_from_alice</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key_from_alice</span><span class="o">.</span><span class="n">content</span> <span class="o">==</span> <span class="n">key_check_bob_string</span><span class="p">:</span>
            <span class="n">bob</span><span class="o">.</span><span class="n">send_classical</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="s1">&#39;Success&#39;</span><span class="p">,</span> <span class="n">await_ack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bob</span><span class="o">.</span><span class="n">send_classical</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="s1">&#39;Fail&#39;</span><span class="p">,</span> <span class="n">await_ack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>If the eavesdropping is turned on, Eve runs the function eve_sniffing_quantum. She intercepts a qubit that is sent from Alice to Bob. She measures the qubit with probability 0.5.
For the measurement of the qubit, she randomly chooses the basis (rectilinear or diagonal).</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eve_sniffing_quantum</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span><span class="n">receiver</span><span class="p">,</span><span class="n">qubit</span><span class="p">):</span>
    <span class="c1"># Eve will manipulate only part of the qubits she intercepts</span>
    <span class="c1"># She chooses the base in which she measures at random.</span>
    <span class="k">if</span> <span class="n">sender</span> <span class="o">==</span> <span class="s1">&#39;Alice&#39;</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">qubit</span><span class="o">.</span><span class="n">H</span><span class="p">()</span>
            <span class="n">qubit</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">non_destructive</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The full example is given below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># This example implements the B92 QKD protocol using the QuNetSim package</span>

<span class="kn">from</span> <span class="nn">qunetsim.components</span> <span class="kn">import</span> <span class="n">Host</span><span class="p">,</span> <span class="n">Network</span>
<span class="kn">from</span> <span class="nn">qunetsim.objects</span> <span class="kn">import</span> <span class="n">Qubit</span>
<span class="kn">from</span> <span class="nn">qunetsim.objects</span> <span class="kn">import</span> <span class="n">Logger</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span><span class="p">,</span> <span class="n">random</span>

<span class="n">Logger</span><span class="o">.</span><span class="n">DISABLED</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">wait_time</span> <span class="o">=</span> <span class="mi">60</span>


<span class="k">def</span> <span class="nf">eve_sniffing_quantum</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">receiver</span><span class="p">,</span> <span class="n">qubit</span><span class="p">):</span>
    <span class="c1"># Eve will manipulate only part of the qubits she intercepts</span>
    <span class="c1"># She chooses the base in which she measures at random.</span>
    <span class="k">if</span> <span class="n">sender</span> <span class="o">==</span> <span class="s1">&#39;Alice&#39;</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">qubit</span><span class="o">.</span><span class="n">H</span><span class="p">()</span>
            <span class="n">qubit</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">non_destructive</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">build_network_b92</span><span class="p">(</span><span class="n">eve_interception</span><span class="p">):</span>

    <span class="n">network</span> <span class="o">=</span> <span class="n">Network</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span>

    <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Eve&#39;</span><span class="p">]</span>
    <span class="n">network</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>

    <span class="n">host_alice</span> <span class="o">=</span> <span class="n">Host</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">)</span>
    <span class="n">host_bob</span> <span class="o">=</span> <span class="n">Host</span><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">)</span>
    <span class="n">host_eve</span> <span class="o">=</span> <span class="n">Host</span><span class="p">(</span><span class="s1">&#39;Eve&#39;</span><span class="p">)</span>

    <span class="n">host_alice</span><span class="o">.</span><span class="n">add_connection</span><span class="p">(</span><span class="s1">&#39;Eve&#39;</span><span class="p">)</span>
    <span class="n">host_eve</span><span class="o">.</span><span class="n">add_connections</span><span class="p">([</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">])</span>
    <span class="n">host_bob</span><span class="o">.</span><span class="n">add_connection</span><span class="p">(</span><span class="s1">&#39;Eve&#39;</span><span class="p">)</span>
    <span class="c1"># adding the connections - Alice wants to transfer an encrypted message to Bob</span>
    <span class="c1"># The network looks like this: Alice---Eve---Bob</span>

    <span class="n">host_alice</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">host_bob</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="mf">0.3</span>

    <span class="c1"># starting</span>
    <span class="n">host_alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">host_bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">host_eve</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="n">network</span><span class="o">.</span><span class="n">add_hosts</span><span class="p">([</span><span class="n">host_alice</span><span class="p">,</span> <span class="n">host_bob</span><span class="p">,</span> <span class="n">host_eve</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">eve_interception</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">host_eve</span><span class="o">.</span><span class="n">q_relay_sniffing</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">host_eve</span><span class="o">.</span><span class="n">q_relay_sniffing_fn</span> <span class="o">=</span> <span class="n">eve_sniffing_quantum</span>

    <span class="n">hosts</span> <span class="o">=</span> <span class="p">[</span><span class="n">host_alice</span><span class="p">,</span> <span class="n">host_bob</span><span class="p">,</span> <span class="n">host_eve</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Made a network!&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">network</span><span class="p">,</span> <span class="n">hosts</span>


<span class="k">def</span> <span class="nf">generate_key</span><span class="p">(</span><span class="n">key_length</span><span class="p">):</span>
    <span class="n">generated_key</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">key_length</span><span class="p">):</span>
        <span class="n">generated_key</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Generated the key {generated_key}&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">generated_key</span>


<span class="k">def</span> <span class="nf">sender_qkd</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">,</span> <span class="n">receiver</span><span class="p">):</span>
    <span class="n">sent_qubit_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">secret_key</span><span class="p">:</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">while</span> <span class="n">success</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">qubit</span> <span class="o">=</span> <span class="n">Qubit</span><span class="p">(</span><span class="n">alice</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">qubit</span><span class="o">.</span><span class="n">H</span><span class="p">()</span>
            <span class="c1"># If we want to send 0, we&#39;ll send |0&gt;</span>
            <span class="c1"># If we want to send 1, we&#39;ll send |+&gt;</span>
            <span class="n">alice</span><span class="o">.</span><span class="n">send_qubit</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">qubit</span><span class="p">,</span> <span class="n">await_ack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">get_next_classical</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">wait</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="o">==</span> <span class="s1">&#39;qubit successfully acquired&#39;</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Alice sent qubit {sent_qubit_counter+1} to Bob&#39;</span><span class="p">)</span>
                    <span class="n">success</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">sent_qubit_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c1"># if, however, message says Bob failed to measure the qubit, Alice will resend it.</span>


<span class="k">def</span> <span class="nf">receiver_qkd</span><span class="p">(</span><span class="n">bob</span><span class="p">,</span> <span class="n">key_size</span><span class="p">,</span> <span class="n">sender</span><span class="p">):</span>
    <span class="n">key_array</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">received_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># counts the key bits successfully measured by Bob</span>
    <span class="k">while</span> <span class="n">received_counter</span> <span class="o">&lt;</span> <span class="n">key_size</span><span class="p">:</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># 0 means rectilinear basis and 1 means diagonal basis</span>
        <span class="n">qubit</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">get_qubit</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="n">wait_time</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">qubit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">qubit</span><span class="o">.</span><span class="n">H</span><span class="p">()</span>
            <span class="n">bit</span> <span class="o">=</span> <span class="n">qubit</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">resulting_key_bit</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">elif</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">resulting_key_bit</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">message_to_send</span> <span class="o">=</span> <span class="s1">&#39;qubit successfully acquired&#39;</span>
                <span class="n">key_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resulting_key_bit</span><span class="p">)</span>
                <span class="n">received_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Bob received qubit {received_counter}&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">message_to_send</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
            <span class="n">bob</span><span class="o">.</span><span class="n">send_classical</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">message_to_send</span><span class="p">,</span> <span class="n">await_ack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">key_array</span>


<span class="k">def</span> <span class="nf">check_key_sender</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">key_check_alice</span><span class="p">,</span> <span class="n">receiver</span><span class="p">):</span>
    <span class="n">key_check_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">key_check_alice</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Alice</span><span class="se">\&#39;</span><span class="s1">s key to check is {key_check_string}&#39;</span><span class="p">)</span>
    <span class="n">alice</span><span class="o">.</span><span class="n">send_classical</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">key_check_string</span><span class="p">,</span> <span class="n">await_ack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">message_from_bob</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">get_next_classical</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">wait</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Bob tells Alice whether the key part is the same at his end.</span>
    <span class="c1"># If not - it means Eve eavesdropped.</span>
    <span class="k">if</span> <span class="n">message_from_bob</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">message_from_bob</span><span class="o">.</span><span class="n">content</span> <span class="o">==</span> <span class="s1">&#39;Success&#39;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Key is successfully verified&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">message_from_bob</span><span class="o">.</span><span class="n">content</span> <span class="o">==</span> <span class="s1">&#39;Fail&#39;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Key has been corrupted&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">check_key_receiver</span><span class="p">(</span><span class="n">bob</span><span class="p">,</span> <span class="n">key_check_bob</span><span class="p">,</span> <span class="n">sender</span><span class="p">):</span>
    <span class="n">key_check_bob_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">key_check_bob</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Bob</span><span class="se">\&#39;</span><span class="s1">s key to check is {key_check_bob_string}&#39;</span><span class="p">)</span>
    <span class="n">key_from_alice</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">get_next_classical</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">wait</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">key_from_alice</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key_from_alice</span><span class="o">.</span><span class="n">content</span> <span class="o">==</span> <span class="n">key_check_bob_string</span><span class="p">:</span>
            <span class="n">bob</span><span class="o">.</span><span class="n">send_classical</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="s1">&#39;Success&#39;</span><span class="p">,</span> <span class="n">await_ack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bob</span><span class="o">.</span><span class="n">send_classical</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="s1">&#39;Fail&#39;</span><span class="p">,</span> <span class="n">await_ack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">alice_func</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">bob_id</span><span class="p">,</span> <span class="n">length_of_check</span><span class="p">,</span> <span class="n">key_length</span><span class="p">):</span>
    <span class="n">encryption_key_binary</span> <span class="o">=</span> <span class="n">generate_key</span><span class="p">(</span><span class="n">key_length</span><span class="p">)</span>
    <span class="n">sender_qkd</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">encryption_key_binary</span><span class="p">,</span> <span class="n">bob_id</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Sent all the qubits sucessfully!&#39;</span><span class="p">)</span>
    <span class="n">key_to_test</span> <span class="o">=</span> <span class="n">encryption_key_binary</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">length_of_check</span><span class="p">]</span>
    <span class="n">check_key_sender</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">key_to_test</span><span class="p">,</span> <span class="n">bob_id</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">bob_func</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">alice_id</span><span class="p">,</span> <span class="n">length_of_check</span><span class="p">,</span> <span class="n">key_length</span><span class="p">):</span>
    <span class="n">secret_key_bob</span> <span class="o">=</span> <span class="n">receiver_qkd</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">key_length</span><span class="p">,</span> <span class="n">alice_id</span><span class="p">)</span>
    <span class="n">key_to_test</span> <span class="o">=</span> <span class="n">secret_key_bob</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">length_of_check</span><span class="p">]</span>
    <span class="n">check_key_receiver</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">key_to_test</span><span class="p">,</span> <span class="n">alice_id</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">b92_protocol</span><span class="p">(</span><span class="n">eve_interception</span><span class="p">,</span> <span class="n">key_length</span><span class="p">,</span> <span class="n">length_of_check</span><span class="p">):</span>
    <span class="n">network</span><span class="p">,</span> <span class="n">hosts</span> <span class="o">=</span> <span class="n">build_network_b92</span><span class="p">(</span><span class="n">eve_interception</span><span class="p">)</span>
    <span class="n">alice</span> <span class="o">=</span> <span class="n">hosts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bob</span> <span class="o">=</span> <span class="n">hosts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">bob_id</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">host_id</span>
    <span class="n">alice_id</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">host_id</span>

    <span class="n">thread_1</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">run_protocol</span><span class="p">(</span><span class="n">alice_func</span><span class="p">,</span> <span class="p">(</span><span class="n">bob_id</span><span class="p">,</span> <span class="n">length_of_check</span><span class="p">,</span> <span class="n">key_length</span><span class="p">,))</span>
    <span class="n">thread_2</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">run_protocol</span><span class="p">(</span><span class="n">bob_func</span><span class="p">,</span> <span class="p">(</span><span class="n">alice_id</span><span class="p">,</span> <span class="n">length_of_check</span><span class="p">,</span> <span class="n">key_length</span><span class="p">,))</span>

    <span class="n">thread_1</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="n">thread_2</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

    <span class="n">network</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">key_length</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">length_of_check</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">key_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="c1"># length of part of the key used to check whether Eve listened</span>
    <span class="n">eve_interception</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="c1"># the eavesdropping can be turned on and off</span>
    <span class="n">b92_protocol</span><span class="p">(</span><span class="n">eve_interception</span><span class="p">,</span> <span class="n">key_length</span><span class="p">,</span> <span class="n">length_of_check</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Stephen DiAdamo, Janis NÃ¶tzel

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>